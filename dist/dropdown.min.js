(function(a,b){if('function'==typeof define&&define.amd)define(['exports'],b);else if('undefined'!=typeof exports)b(exports);else{var c={exports:{}};b(c.exports),a.dropdown=c.exports}})(this,function(a){'use strict';function b(f,g){if(!(f instanceof g))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(a,'__esModule',{value:!0});var c=function(){function f(g,h){for(var k,j=0;j<h.length;j++)k=h[j],k.enumerable=k.enumerable||!1,k.configurable=!0,'value'in k&&(k.writable=!0),Object.defineProperty(g,k.key,k)}return function(g,h,j){return h&&f(g.prototype,h),j&&f(g,j),g}}(),d=function(){function f(g){var h=this,j=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};b(this,f),this.logger=j.logger?j.logger:console.log.bind(console),this.dismiss=this.dismiss.bind(this),this.ul=this._createList(g),this.ul.classList.add('dropdown'),this._keyboardHandlers={38:function(l,m){return h._go(!0,l,m)},40:function(l,m){return h._go(!1,l,m)},37:function(l,m){l&&l.parentElement!==h.ul&&l.parentElement.parentElement!==h.ul?(l.classList.remove(f._activeClassName),l.parentElement.parentElement.classList.remove(f._openClassName),l.parentElement.parentElement.classList.add(f._activeClassName)):m&&m!==h.ul&&f._closeRelated(m.parentElement)},39:function(l){l&&l.classList.contains(f._subnavClassName)&&(f._openNested(l),l.querySelector('li').classList.add(f._activeClassName))},13:function(l){return l&&l.click()},27:this.dismiss},(j.context?j.context:document.body).appendChild(this.ul),this._keyboardNavigation=this._keyboardNavigation.bind(this)}return c(f,null,[{key:'_closeRelated',value:function(h){h.parentElement.querySelectorAll('.'+f._openClassName).forEach(function(j){j.classList.remove(f._openClassName)})}},{key:'_openNested',value:function(h){f._closeRelated(h),h.classList.add(f._openClassName);var j=h.querySelector('ul'),k=h.getBoundingClientRect(),l=j.getBoundingClientRect();k.right+l.width>window.innerWidth?(j.style.left='',j.style.right=f._nestedXPos):(j.style.right='',j.style.left=f._nestedXPos),k.top+l.height>window.innerHeight?(j.style.top='',j.style.bottom=f._nestedYPos):(j.style.bottom='',j.style.top=f._nestedYPos)}},{key:'_subnavClassName',get:function(){return'subnav'}},{key:'_openClassName',get:function(){return'open'}},{key:'_activeClassName',get:function(){return'active'}},{key:'_disabledClassName',get:function(){return'disabled'}},{key:'_nestedXPos',get:function(){return'95%'}},{key:'_nestedYPos',get:function(){return'-0.2em'}}]),c(f,[{key:'_createList',value:function(h){var j=this,k=document.createElement('ul');return h.forEach(function(l){var m=document.createElement('li');m.innerText=l.label,l.disabled?(m.classList.add(f._disabledClassName),m.addEventListener('click',function(n){n.preventDefault(),n.stopPropagation()})):(m.addEventListener('mouseleave',function(n){j.logger('mouseleave',n),clearTimeout(j.timeout),n.target.classList.remove(f._activeClassName)}),m.addEventListener('mouseenter',function(n){j.logger('mouseenter',n),n.target.classList.add(f._activeClassName),clearTimeout(j.timeout),j.timeout=l.children?setTimeout(f._openNested.bind(null,n.target),500):setTimeout(f._closeRelated.bind(null,n.target),500)}),l.children?(m.addEventListener('click',function(n){n.target===this&&(f._openNested(m),n.preventDefault(),n.stopPropagation())}),m.appendChild(j._createList(l.children)),m.classList.add(f._subnavClassName)):'string'==typeof l.action?m.addEventListener('click',function(){return window.location.href=l.action}):'function'==typeof l.action&&m.addEventListener('click',l.action)),k.appendChild(m)}),k}},{key:'_go',value:function(h,j,k){var l=function(n){return h?n.previousElementSibling:n.nextElementSibling};j&&j.classList.remove(f._activeClassName);for(var m=j&&l(j)||k.children[h?k.children.length-1:0];m&&m.classList.contains(f._disabledClassName);)m=l(m);return m&&m.classList.add(f._activeClassName),m}},{key:'_keyboardNavigation',value:function(h){var j=this.ul.querySelectorAll('.'+f._openClassName+' > ul');j=0<j.length?j[j.length-1]:this.ul;var k=j.querySelector('li.'+f._activeClassName);this.logger(j);var l=''+h.keyCode;this._keyboardHandlers.hasOwnProperty(l)&&(h.stopPropagation(),h.preventDefault(),this._keyboardHandlers[l](k,j))}},{key:'dismiss',value:function(){this.logger('dismiss'),this.ul.classList.remove(f._openClassName),document.removeEventListener('keydown',this._keyboardNavigation),document.removeEventListener('click',this.dismiss),this.ul.querySelectorAll('li').forEach(function(h){h.classList.remove(f._openClassName,f._activeClassName)})}},{key:'openClick',value:function(h){if(this.logger(h),h.stopPropagation(),h.preventDefault(),h.clientX&&h.clientY)return this.open(window.pageXOffset+h.clientX,window.pageYOffset+h.clientY,!0);var j=h.target.getBoundingClientRect();return this.open(window.pageXOffset+j.right,window.pageYOffset+j.bottom,!0)}},{key:'open',value:function(h,j){var k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;this.ul.querySelectorAll('.'+f._openClassName+',.'+f._activeClassName).forEach(function(m){m.classList.remove(f._openClassName,f._activeClassName)}),this.ul.classList.add(f._openClassName);var l=this.ul.getBoundingClientRect();return this.ul.style.left=h+'px',this.ul.style.top=j+'px',k&&(h+l.width>=window.pageXOffset+window.innerWidth&&(this.ul.style.left=h-l.width+'px'),j+l.height>=window.pageYOffset+window.innerHeight&&(this.ul.style.top=j-l.height+'px')),document.addEventListener('keydown',this._keyboardNavigation),document.addEventListener('click',this.dismiss),this.ul}}]),f}();a.default=d});
//# sourceMappingURL=dropdown.js.map
