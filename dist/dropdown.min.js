(function(a,b){if('function'==typeof define&&define.amd)define(['exports'],b);else if('undefined'!=typeof exports)b(exports);else{var c={exports:{}};b(c.exports),a.dropdown=c.exports}})(this,function(a){'use strict';function b(f,g){if(!(f instanceof g))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(a,'__esModule',{value:!0});var c=function(){function f(g,h){for(var k,j=0;j<h.length;j++)k=h[j],k.enumerable=k.enumerable||!1,k.configurable=!0,'value'in k&&(k.writable=!0),Object.defineProperty(g,k.key,k)}return function(g,h,j){return h&&f(g.prototype,h),j&&f(g,j),g}}(),d=function(){function f(g){var h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};b(this,f),this.dismiss=this.dismiss.bind(this),this._keyboardNavigation=this._keyboardNavigation.bind(this),this.logger=h.logger?h.logger:console.log.bind(console),this.navList=g,this._items={},this.ul=this._createList(g,'item'),this.ul.classList.add(f._baseClassName),(h.context?h.context:document.body).appendChild(this.ul)}return c(f,[{key:'_keyboardHandlers',get:function(){var h=this;return{38:function(k,l){return h._go(!0,k,l)},40:function(k,l){return h._go(!1,k,l)},37:function(k,l){k&&k.parentElement!==h.ul&&k.parentElement.parentElement!==h.ul?(k.classList.remove(f._activeClassName),k.parentElement.parentElement.classList.remove(f._openClassName),k.parentElement.parentElement.classList.add(f._activeClassName)):l&&l!==h.ul&&f._closeRelated(l.parentElement)},39:function(k){k&&k.classList.contains(f._subnavClassName)&&(f._openNested(k),k.querySelector('li').classList.add(f._activeClassName))},13:function(k){return k&&k.click()},27:this.dismiss}}}],[{key:'_closeRelated',value:function(h){h.parentElement.querySelectorAll('.'+f._openClassName).forEach(function(j){j.classList.remove(f._openClassName)})}},{key:'_openNested',value:function(h){f._closeRelated(h),h.classList.add(f._openClassName);var j=h.querySelector('ul'),k=h.getBoundingClientRect(),l=j.getBoundingClientRect();k.right+l.width>window.innerWidth?(j.style.left='',j.style.right=f._nestedXPos):(j.style.right='',j.style.left=f._nestedXPos),k.top+l.height>window.innerHeight?(j.style.top='',j.style.bottom=f._nestedYPos):(j.style.bottom='',j.style.top=f._nestedYPos)}},{key:'_baseClassName',get:function(){return'dropdown'}},{key:'_subnavClassName',get:function(){return'subnav'}},{key:'_openClassName',get:function(){return'open'}},{key:'_dividerClassName',get:function(){return'divider'}},{key:'_activeClassName',get:function(){return'active'}},{key:'_disabledClassName',get:function(){return'disabled'}},{key:'_nestedXPos',get:function(){return'95%'}},{key:'_nestedYPos',get:function(){return'-0.2em'}}]),c(f,[{key:'_createList',value:function(h,j){var k=this,l=document.createElement('ul'),m=this;return l.addEventListener('click',function(n){var o=n.target.getAttribute('data-key');if(o&&m._items[o]){var p=m._items[o],q=p.li,r=p.navElt;return r.disabled||!r.label?(n.preventDefault(),void n.stopPropagation()):void(r.children?(f._openNested(q),n.preventDefault(),n.stopPropagation()):'string'==typeof r.action?window.location.href=r.action:'function'==typeof r.action&&r.action.call(this,n))}}),h.forEach(function(n,o){var p=document.createElement('li');if(n.key=n.key?n.key:j+'-'+o,k._items.hasOwnProperty(n.key))throw new Error('Got duplicate key');else k._items[n.key]={navElt:n,li:p};p.setAttribute('data-key',n.key);var q='undefined'==typeof n.label;(n.disabled||q)&&p.classList.add(f._disabledClassName),q?p.classList.add(f._dividerClassName):p.innerText=n.label,p.addEventListener('mouseleave',function(r){k.logger('mouseleave',r),clearTimeout(k.timeout),r.target.classList.remove(f._activeClassName)}),p.addEventListener('mouseenter',function(r){return k.logger('mouseenter',r),clearTimeout(k.timeout),n.disabled||q?void(k.timeout=setTimeout(f._closeRelated.bind(null,r.target),500)):void(r.target.classList.add(f._activeClassName),clearTimeout(k.timeout),k.timeout=n.children?setTimeout(f._openNested.bind(null,r.target),500):setTimeout(f._closeRelated.bind(null,r.target),500))}),n.children&&(p.appendChild(k._createList(n.children,n.key)),p.classList.add(f._subnavClassName)),l.appendChild(p)}),l}},{key:'setDisabledState',value:function(h,j){var k=this._items[h],l=k.li,m=k.navElt;m.disabled=j,j?(l.classList.add(f._disabledClassName),l.classList.remove(f._openClassName),l.classList.remove(f._activeClassName),l.querySelectorAll('.'+f._openClassName+', .'+f._activeClassName).forEach(function(n){n.classList.remove(f._openClassName),n.classList.remove(f._activeClassName)})):l.classList.remove(f._disabledClassName)}},{key:'_go',value:function(h,j,k){var l=function(n){return h?n.previousElementSibling:n.nextElementSibling};j&&j.classList.remove(f._activeClassName);for(var m=j&&l(j)||k.children[h?k.children.length-1:0];m&&m.classList.contains(f._disabledClassName);)m=l(m);return m&&m.classList.add(f._activeClassName),m}},{key:'_keyboardNavigation',value:function(h){var j=this.ul.querySelectorAll('.'+f._openClassName+' > ul');j=0<j.length?j[j.length-1]:this.ul;var k=j.querySelector('li.'+f._activeClassName);this.logger(j);var l=''+h.keyCode;this._keyboardHandlers.hasOwnProperty(l)&&(h.stopPropagation(),h.preventDefault(),this._keyboardHandlers[l](k,j))}},{key:'dismiss',value:function(){this.logger('dismiss'),this.ul.classList.remove(f._openClassName),document.removeEventListener('keydown',this._keyboardNavigation),document.removeEventListener('click',this.dismiss),this.ul.querySelectorAll('li').forEach(function(h){h.classList.remove(f._openClassName),h.classList.remove(f._activeClassName)})}},{key:'openClick',value:function(h){if(this.logger(h),h.stopPropagation(),h.preventDefault(),h.clientX&&h.clientY)return this.open(window.pageXOffset+h.clientX,window.pageYOffset+h.clientY,!0);var j=h.target.getBoundingClientRect();return this.open(window.pageXOffset+j.right,window.pageYOffset+j.bottom,!0)}},{key:'open',value:function(h,j){var k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;this.ul.querySelectorAll('.'+f._openClassName+',.'+f._activeClassName).forEach(function(m){m.classList.remove(f._openClassName),m.classList.remove(f._activeClassName)}),this.ul.classList.add(f._openClassName);var l=this.ul.getBoundingClientRect();return this.ul.style.left=h+'px',this.ul.style.top=j+'px',k&&(h+l.width>=window.pageXOffset+window.innerWidth&&(this.ul.style.left=h-l.width+'px'),j+l.height>=window.pageYOffset+window.innerHeight&&(this.ul.style.top=j-l.height+'px')),document.addEventListener('keydown',this._keyboardNavigation),document.addEventListener('click',this.dismiss),this.ul}}]),f}();a.default=d});
//# sourceMappingURL=dropdown.js.map
